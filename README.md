# Фильтр желтушных новостей

Данный проект позволяет оценивать статьи с сайта [ИНОСМИ.РУ](https://inosmi.ru/). Он подсчитывает количество слов в статье и определяет её рейтинг на основании упоминания определенных слов.

Пока поддерживается только один новостной сайт - [ИНОСМИ.РУ](https://inosmi.ru/). Для него разработан специальный адаптер, умеющий выделять текст статьи на фоне остальной HTML разметки. Для других новостных сайтов потребуются новые адаптеры, все они будут находиться в каталоге `adapters`. Туда же помещен код для сайта ИНОСМИ.РУ: `adapters/inosmi_ru.py`.

В перспективе можно создать универсальный адаптер, подходящий для всех сайтов, но его разработка будет сложной и потребует дополнительных времени и сил.

# Как установить

Вам понадобится Python версии 3.7 или старше. Для установки пакетов рекомендуется создать виртуальное окружение.

Первым шагом установите пакеты:

```python3
pip install -r requirements.txt
```

# Словари слов
Словари со словами находятся в папке `charged_dict`. Там уже есть пару словарей. Для работы программы вам необходимо выбрать какой-либо из существующих словарей, либо указать путь до вашего словаря.

Запишите этот путь в файле `.env`:
```
PATH_TO_DICT=
```

# Как запустить

```python3
python server.py
```

Сервер будет работать по локальному адресу [localhost](http://127.0.0.1:8080/?urls=)

Для того, чтобы заставить его обрабатывать статьи, через запятую их нужно добавлять в сам запрос. Вот запрос в качестве примера:
```
http://127.0.0.1:8080/?urls=https://inosmi.ru/20230619/raketa-263752174.html,https://inosmi.ru/20190629/245384784
```
Сервер на запрос отправляет `JSON-строку`:
```
{"urls": [{"url": "https://inosmi.ru/20190629/245384784", "status": "FETCH_ERROR", "words_count": null, "score": null}, {"url": "https://inosmi.ru/20230619/raketa-263752174.html", "status": "OK", "words_count": 420, "score": 0.24}]}
```
Нельзя за один запрос передать больше 10 статей, иначе будет ошибка.

Как видно из ответа JSON, если ссылка битая или ведёт не на тот сайт, то обработчик вернёт ошибку.

# Как запустить тесты

Для тестирования используется [pytest](https://docs.pytest.org/en/latest/), тестами покрыты фрагменты кода сложные в отладке: text_tools.py и адаптеры. Команды для запуска тестов:

```
python -m pytest adapters/inosmi_ru.py
```

```
python -m pytest text_tools.py
```

```
python -m pytest server.py
```

# Цели проекта

Код написан в учебных целях. Это урок из курса по веб-разработке — [Девман](https://dvmn.org).
